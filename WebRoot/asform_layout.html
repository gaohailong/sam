<div class="row-fluid">
	<div class="span12">
		<h3 class="page-title">
			资产管理 <small></small>
		</h3>
		<ul class="breadcrumb">
			<li><i class="icon-home"></i> <a href="">主页</a> <span
				class="icon-angle-right"></span></li>
			<li><a href="#">资产管理</a> <span class="icon-angle-right"></span>
			</li>
			<li><a href="asform_layout.html">资产的入库</a></li>
		</ul>
	</div>
</div>
<!-- END PAGE HEADER-->
<!-- BEGIN PAGE CONTENT-->
<form id="acceptForm"></form>
<div class="row-fluid">
	<div class="span12">
		<!-- BEGIN SAMPLE FORM PORTLET-->
		<div class="portlet box red tabbable">
			<div class="portlet-title">
				<div class="caption">
					<i class="icon-reorder"></i> <span class="hidden-480">入库单</span>
				</div>
				<div class="actions">
					<button class="btn blue" onclick="javascript:addAcceptForm();">
						<i class="icon-check"></i> 确定
					</button>
					<a href="#" data-toggle="modal" class="btn yellow "><i
						class="icon-pencil"></i> Edit</a> <a href="#responsive"
						data-toggle="modal" class="btn green "><i class="icon-plus"></i>
						添加产品</a>
				</div>
			</div>
			<div class="portlet-body">
				<form action="#" class="form-horizontal">
					<div class="row-fluid">
						<div class="control-group" style="margin-top: 25px;">
							<label class="control-label span2">存放地点</label>
							<div class="controls span2">
								<select class="medium m-wrap" tabindex="1" id="ahname">
								</select>
							</div>
							<label class="control-label span3">增加方式</label>
							<div class="controls span2">
								<select class="medium m-wrap" tabindex="1" id="aatype">
									<option value="购买">购买</option>
									<option value="租赁">租赁</option>
									<option value="捐赠">捐赠</option>
								</select>
							</div>
						</div>
						<div class="control-group">
							<label class="control-label span2">入库人</label>
							<div class="controls span2">
								<input type="text" class="m-wrap medium" id="aaname" /> <span></span>
							</div>
							<label class="control-label span3">总件数</label>
							<div class="controls span2">
								<input type="text" class="m-wrap medium" placeholder="请输入整数" id="aanumber" /> <span
									class="help-inline"></span>
							</div>
						</div>

						<div class="control-group" style="margin-top: -18px;">
							<label class="control-label span2">总价格</label>
							<div class="controls span2">
								<input type="text" class="m-wrap medium" placeholder="请输入数字" id="aaprice" />
							</div>
						</div>
					</div>
				</form>


			</div>
			<div id="responsive" class="modal hide fade" tabindex="-1"
				data-width="760">
				<div class="modal-header">
					<span class="hidden-480">资产入库表</span>
				</div>
				<div class="modal-body">
					<div class="portlet-body form">
						<div class="tabbable portlet-tabs">
							<div class="tab-content">
								<div class="tab-pane active" id="portlet_tab1">
									<!-- BEGIN FORM-->
									<div class="form-horizontal">
										<div class="control-group">
											<div class="control-group"></div>
											<div class="control-group"></div>
											<div class="control-group"></div>
											<label class="control-label">资产型号</label>
											<div class="controls">
												<input type="text" id="item_as_type" class="m-wrap medium" />
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">资产名称</label>
											<div class="controls">
												<input type="text" id="item_as_name" class="m-wrap medium" />
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">资产类别</label>
											<div class="controls">
												<select class="medium m-wrap" onchange="javascript:selectSencondAssetType(this.value);" id="item_as_cate" tabindex="1">
												</select> 
												<select class="medium m-wrap" id="item_as_cateDetail"
													tabindex="1">
												</select>
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">仓库名称</label>
											<div class="controls">
												<select class="medium m-wrap" tabindex="1"
													id="item_as_houseDetail">
												</select>
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">生产日期</label>
											<div class="controls">
												<div class="input-append date date-picker m-wrap medium"
													data-date="2016/12/02" data-date-format="yyyy/mm/dd"
													data-date-viewmode="years">
				
													<input class="m-wrap m-ctrl-medium date-picker" readonly
														size="16" type="text" value="" id="item_as_measuer" /> <span
														class="add-on"><i class="icon-calendar"></i></span>
												</div>
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">资产生产商</label>
											<div class="controls">
												<input class="m-wrap medium" id="item_as_supply" type="text"
													placeholder="" />
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">资产保质期</label>
											<div class="controls">
												<div class="input-append date date-picker m-wrap medium"
													data-date="2016/12/02" data-date-format="yyyy/mm/dd"
													data-date-viewmode="years">
				
													<input class="m-wrap m-ctrl-medium date-picker" readonly
														size="16" type="text" value="" id="item_as_life" /> <span
														class="add-on"><i class="icon-calendar"></i></span>
												</div>
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">资产折旧方法</label>
											<div class="controls">
												<select class="medium m-wrap" id="item_as_depreciation" tabindex="1">
													<option value="平均折旧法">平均折旧法</option>
												</select>
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">资产残值率</label>
											<div class="controls">
												<input class="m-wrap medium" id="item_as_remainratio"
													type="text" placeholder="" />
											</div>
										</div>
										<div class="control-group">
											<label class="control-label">资产备注</label>
											<div class="controls">
												<textarea class="large m-wrap" id="item_as_introduce"
													rows="3"></textarea>
											</div>
										</div>
										<button id="accept-tbody-reset" class="hide"
											onclick="clearLittleForm()"></button>
									</div>
									<!-- END FORM-->
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button id="accept-tbody-close" type="button" data-dismiss="modal"
						class="btn">关闭</button>
					<button type="button" class="btn blue" onclick="addOne()">保存</button>
				</div>
			</div>
		</div>
		<!-- BEGIN EXAMPLE TABLE PORTLET-->
		<div class="portlet box red">
			<div class="portlet-title">
				<div class="caption">
					<i class="icon-edit"></i>入库单详情
				</div>
			</div>
			<div class="portlet-body">
				<table class="table table-striped table-hover table-bordered"
					id="sample_editable_1">
					<thead>
						<tr>
							<th>设备型号</th>
							<th>设备名称</th>
							<th>类型名称</th>
							<th>仓库名称</th>
							<th>生产日期</th>
							<th>生产单位</th>
							<th>保质期</th>
							<th>折旧方法</th>
							<th>残值率</th>
							<th>设备备注</th>
							<th>操作</th>
							<th>删除本行</th>
						</tr>
					</thead>
					<tbody id="accept-tbody">
					</tbody>
				</table>
			</div>
		</div>
		<!-- END PAGE CONTENT-->
	</div>
	<!-- END PAGE CONTAINER-->
</div>
<!-- END PAGE -->
<script type="text/javascript">

		jQuery(document).ready(function() {
		
		CommonCalendarComponents.init();
		findAssetTypeFirst();
		selectWareHouse1();
	});
	
	
		function findAssetTypeFirst() {
			$.ajax({
				type : "get",
				url : "/sam/assetType/findAssetTypeFirst",
				dataType : "JSON",
				success : function(data) {
					$("#item_as_cate").append('<option value="">请选择</option>');
					$(data).each(
							function(index, val) {
								$("#item_as_cate").append(
										"<option value='"+val.atid+"'>"
												+ val.atname + "</option>");
							});
	
				},
				error : function(data) {
					alert(data.status);
				}
			});
		}
		
		function selectSencondAssetType(atid){
			alert(atid)
			$.ajax({
			type : "POST",
			url : "/sam/assetType/findAllSecondAssetHouse",
			data : "atid="+atid,
			dataType : "JSON",
			success : function(data) {
			$("#item_as_cateDetail").html("");
			$("#item_as_cateDetail").append('<option value="">请选择</option>');
				$(data).each(
						function(index, value) {
							$("#item_as_cateDetail").append(
								"<option value='"+value.atname+"'>"+value.atname+"</option>"
							);
						});

			},
			error : function(data) {
				alert(data.status);
			}
		});
		
		}
		
		function selectWareHouse1() {
		$.ajax({
			type : "get",
			url : "/sam/wareHouse/findAllSecondAssetHouse",
			dataType : "JSON",
			success : function(data) {
			$("#ahname").html("");
			$("#ahname").append('<option value="">请选择</option>');
			$("#item_as_houseDetail").html("");
			$("#item_as_houseDetail").append('<option value="">请选择</option>');
				$(data).each(
						function(index, value) {
							$("#ahname").append(
								"<option value='"+value.ahname+"'>"+value.ahname+"</option>"
							);
							$("#item_as_houseDetail").append(
								"<option value='"+value.ahname+"'>"+value.ahname+"</option>"
							);
						});

			},
			error : function(data) {
				alert(data.status);
			}
		});
	
		
	}


	function addOne() {
		var type = document.getElementById("item_as_type").value;
		var name = document.getElementById("item_as_name").value;
		var cateDetail = document.getElementById("item_as_cateDetail").value;
		var houseDetail = document.getElementById("item_as_houseDetail").value;
		var measuer = document.getElementById("item_as_measuer").value;
		var supply = document.getElementById("item_as_supply").value;
		var life = document.getElementById("item_as_life").value;
		var depreciation = document.getElementById("item_as_depreciation").value;
		var remainratio = document.getElementById("item_as_remainratio").value;
		var introduce = document.getElementById("item_as_introduce").value;
		var strc = type + "~" + name + "~" + cateDetail + "~" + houseDetail
				+ "~" + measuer + "~" + supply + "~" + life + "~"
				+ depreciation + "~" + remainratio + "~" + introduce;
		$("#acceptForm").append(
				"<input type='hidden' name='acceptName' value='"+strc+"' />");
		var str = "<tr class=''><td>"
				+ type
				+ "</td><td>"
				+ name
				+ "</td><td>"
				+ cateDetail
				+ "</td><td>"
				+ houseDetail
				+ "</td><td>"
				+ measuer
				+ "</td><td>"
				+ supply
				+ "</td><td>"
				+ life
				+ "</td><td>"
				+ depreciation
				+ "</td><td>"
				+ remainratio
				+ "</td><td>"
				+ introduce
				+ "</td><td><a href='javascript:;'>编辑</a></td><td><a class='delete' href='javascript:;'>删除</a></td></tr>";
		$("#accept-tbody").prepend(str);
		$("#accept-tbody-reset").click();
		$("#accept-tbody-close").click();
	}

	function clearLittleForm() {
		$("#accept-tbody-reset").siblings().children().find("input").attr(
				"value", "");
		$("#accept-tbody-reset").siblings().children().find("textarea").attr(
				"value", "");
	}

	function addAcceptForm() {
		var accStr = document.getElementsByName("acceptName");
		var acceptStr = "";
		for (var i = 0; i < accStr.length; i++) {
			acceptStr += accStr[i].value + ",";
		}
		var ahname = document.getElementById("ahname").value;
		var aatype = document.getElementById("aatype").value;
		var aaname = document.getElementById("aaname").value;
		var aaprice = document.getElementById("aaprice").value;
		var aanumber = document.getElementById("aanumber").value;
		alert("123")
		$.ajax({
			type : "post",
			url : "/sam/accept/addAccept",
			data : "acceptStr=" + acceptStr + "&ahname=" + ahname + "&aatype="
					+ aatype + "&aaname=" + aaname + "&aaprice=" + aaprice
					+ "&aanumber=" + aanumber,
			dataType : "JSON",
			success : function(data) {
				if (data > 0) {
					alert("添加成功");
					window.location.reload();
				}
			},
			error : function(data) {
				alert(data.status);
			}
		});

	}
</script>
