
<div class="row-fluid">

	<div class="span12">

		<h3 class="page-title">

			资产管理 <small></small>

		</h3>

		<ul class="breadcrumb">

			<li><i class="icon-home"></i> <a href="">主页</a> <span
				class="icon-angle-right"></span></li>

			<li><a href="#">资产管理</a> <span class="icon-angle-right"></span>

			</li>

			<li><a href="asform_layout.html">资产的维修</a></li>

		</ul>

	</div>

</div>

<!-- END PAGE HEADER-->

<!-- BEGIN PAGE CONTENT-->
<form id="acceptForm"></form>
<div class="row-fluid">

	<div class="span12">

		<!-- BEGIN SAMPLE FORM PORTLET-->

		<div class="portlet box red tabbable">

			<div class="portlet-title">

				<div class="caption">

					<i class="icon-reorder"></i> <span class="hidden-480">维修单</span>

				</div>
				<div class="actions">

					<button onclick="javascript:addRequestForm();" class="btn blue ">
						<i class="icon-check"></i> 确定
					</button>
					<a href="#" data-toggle="modal" class="btn yellow "><i
						class="icon-pencil"></i> Edit</a> <a href="#responsive"
						data-toggle="modal" class="btn green "><i class="icon-plus"></i>
						添加</a>

				</div>


			</div>
			<div class="portlet-body ">

				<form action="#" class="form-horizontal">
					<div class="row-fluid">
						<div class="control-group" style="margin-top:20px">
							<label class="control-label  span2">维修开始时间</label>
							<div class="controls  span2">
								<div class="input-append date date-picker m-wrap medium"
									data-date="2016/12/02" data-date-format="yyyy/mm/dd"
									data-date-viewmode="years">

									<input class="m-wrap m-ctrl-medium date-picker" readonly
										size="16" type="text" value="" id="repairtime" /> <span
										class="add-on"><i class="icon-calendar"></i></span>
								</div>
							</div>
							<label class="control-label span3">维修天数</label>

							<div class="controls span2">
								<input type="text" class="m-wrap medium" placeholder="请输入天数" id="repairday" /> <span
									class="help-inline" ></span>
							</div>

						</div>
						<div class="control-group">
							<label class="control-label span2">维修人员</label>
							<div class="controls span2">
								<input type="text" class="m-wrap medium" placeholder="请输入维修人员名字" id="repairname" /> <span
									class="help-inline"></span>
							</div>
							<label class="control-label span3">联系电话</label>

							<div class="controls span2">
								<input type="text" class="m-wrap medium" placeholder="请输入电话号码,例:152xxxx4398" id="repairphone" /> <span
									class="help-inline"></span>
							</div>
						</div>
					</div>
				</form>

			</div>

			<div id="responsive" class="modal hide fade" tabindex="-1"
				data-width="760">

				<div class="modal-header">

					<span class="hidden-480">资产维修表</span>
				</div>
				<div class="modal-body">

					<div class="portlet-body form">

						<div class="tabbable portlet-tabs">

							<div class="tab-content">

								<div class="tab-pane active" id="portlet_tab1">

									<!-- BEGIN FORM-->

									<div class="form-horizontal">

										<div class="control-group">
											<div class="control-group"></div>
											<div class="control-group"></div>
											<div class="control-group"></div>

											<label class="control-label">设备编号</label>

											<div class="controls">

												<input type="text" id="item_as_idcard" placeholder="请输入设备编号" class="m-wrap medium" />

											</div>

										</div>

										<div class="control-group">

											<div class="controls" id="showInfoDiv"></div>

										</div>

										<button id="accept-tbody-reset" class="hide"
											onclick="clearLittleForm()"></button>

									</div>

									<!-- END FORM-->

								</div>


							</div>

						</div>

					</div>
				</div>

				<div class="modal-footer">

					<button id="accept-tbody-close" type="button" data-dismiss="modal"
						class="btn">关闭</button>

					<button type="button" class="btn blue" onclick="addOne()">保存</button>



				</div>

			</div>

		</div>

		<!-- BEGIN EXAMPLE TABLE PORTLET-->

		<div class="portlet box red">

			<div class="portlet-title">

				<div class="caption">
					<i class="icon-edit"></i>本次维修的:
				</div>


			</div>

			<div class="portlet-body">

				<table class="table">

					<thead>

						<tr>

							<th>设备型号</th>

							<th>设备名称</th>

							<th>类型名称</th>

							<th>仓库名称</th>

							<th>生产日期</th>

							<th>生产单位</th>

							<th>保质期</th>

							<th>折旧方法</th>

							<th>残值率</th>

							<th>设备备注</th>

							<th>操作</th>

							<th>删除本行</th>

						</tr>

					</thead>


					<tbody id="accept-tbody">


					</tbody>


				</table>



				<!-- END EXAMPLE TABLE PORTLET-->

				<!-- END SAMPLE FORM PORTLET-->

			</div>

		</div>

		<!-- END PAGE CONTENT-->

	</div>

	<!-- END PAGE CONTAINER-->

</div>
<!-- END PAGE -->

<!-- 小表单得东西给大table中添加 -->
<script type="text/javascript">

	jQuery(document).ready(function() {
		
		CommonCalendarComponents.init();
	});

	function addOne() {
		var date = document.getElementsByName("hiddenInfoInput");
		var num = date.length;
		var info = date[num - 1].value;
		var i = info.split(",");
		var str = "<tr class=''><td>"
				+ i[0]
				+ "</td><td>"
				+ i[1]
				+ "</td><td>"
				+ i[2]
				+ "</td><td>"
				+ i[3]
				+ "</td><td>"
				+ i[4]
				+ "</td><td>"
				+ i[5]
				+ "</td><td>"
				+ i[6]
				+ "</td><td>"
				+ i[7]
				+ "</td><td>"
				+ i[8]
				+ "</td><td>"
				+ i[9]
				+ "</td><td><a href='javascript:;'>编辑</a></td><td><a class='delete' href='javascript:;'>删除</a></td></tr>";
		$("#accept-tbody").prepend(str);
		$("#accept-tbody-reset").click();
		$("#accept-tbody-close").click();
	}

	function clearLittleForm() {
		$("#accept-tbody-reset").siblings().children().find("input").attr(
				"value", "");
		$("#accept-tbody-reset").siblings().children().find("textarea").attr(
				"value", "");
	}

	$("#item_as_idcard").keyup(function() {
		var aiid = document.getElementById("item_as_idcard").value;
		if (document.getElementById("showInfoSpan") != null) {
			if (document.getElementById("showInfoSpan").innerHTML != null) {
				document.getElementById("showInfoDiv").innerHTML = "";
			}
		}
		checkInfoById(aiid);
	})

	function checkInfoById(aiid) {
		$
				.ajax({
					type : "post",
					url : "/sam/infoController/findInfoByAiid",
					data : "aiid=" + aiid,
					dataType : "JSON",
					success : function(date) {
						if (date != null) {
							$("#showInfoDiv").append(
									"<span id='showInfoSpan'>名称:" + date.ainame
											+ ",状态:" + date.asname + "</span>");
							$("#acceptForm")
									.append(
											"<input type='hidden' name='hiddenInfoAiidInput' value='"+date.aiid+"' ><input type='hidden' name='hiddenInfoInput' value='"+date.aimodel+","+date.ainame+","+date.atname+","+date.ahname+","+date.aimeasuer+","+date.aisupply+","+date.ailife+","+date.aidepreciation+","+date.airemainratio+","+date.airemark+" '>");
						} else {
							$("#showInfoDiv")
									.append(
											"<span id='showInfoSpan'>未查到当前id对应的东西</span>");
						}
					},
					error : function(date) {
						alert(date.status);
					}
				});
	}

	function addRequestForm() {

		var date = document.getElementsByName("hiddenInfoAiidInput");
		var aiidStr = "";
		for (var i = 0; i < date.length; i++) {
			aiidStr += date[i].value + ",";
		}

		var artime = document.getElementById("repairtime").value;
		var arday = document.getElementById("repairday").value;
		var arperson = document.getElementById("repairname").value;
		var arphone = document.getElementById("repairphone").value;

		$.ajax({
			type : "post",
			url : "/sam/requireController/addRequest",
			data : "aiidStr=" + aiidStr + "&artime=" + artime + "&arday="
					+ arday + "&arperson=" + arperson + "&arphone=" + arphone,
			dataType : "JSON",
			success : function(date) {
				if (date > 0) {
					alert("添加成功");
					window.location.reload();
				}
			},
			error : function(date) {
				alert(date.status);
			}
		});

	}

	//条件查询
	function findRepares() {

	}
</script>
