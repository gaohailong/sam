
<div class="row-fluid">

	<div class="span12">

		<!-- BEGIN STYLE CUSTOMIZER -->

		<div class="color-panel hidden-phone">

			<div class="color-mode-icons icon-color"></div>

			<div class="color-mode-icons icon-color-close"></div>

			<div class="color-mode">

				<p>THEME COLOR</p>

				<ul class="inline">

					<li class="color-black current color-default" data-style="default"></li>

					<li class="color-blue" data-style="blue"></li>

					<li class="color-brown" data-style="brown"></li>

					<li class="color-purple" data-style="purple"></li>

					<li class="color-grey" data-style="grey"></li>

					<li class="color-white color-light" data-style="light"></li>

				</ul>

				<label> <span>Layout</span> <select
					class="layout-option m-wrap small">

						<option value="fluid" selected>Fluid</option>

						<option value="boxed">Boxed</option>

				</select>

				</label> <label> <span>Header</span> <select
					class="header-option m-wrap small">

						<option value="fixed" selected>Fixed</option>

						<option value="default">Default</option>

				</select>

				</label> <label> <span>Sidebar</span> <select
					class="sidebar-option m-wrap small">

						<option value="fixed">Fixed</option>

						<option value="default" selected>Default</option>

				</select>

				</label> <label> <span>Footer</span> <select
					class="footer-option m-wrap small">

						<option value="fixed">Fixed</option>

						<option value="default" selected>Default</option>

				</select>

				</label>

			</div>

		</div>

		<!-- END BEGIN STYLE CUSTOMIZER -->

		<h3 class="page-title">

			资产使用情况 <small></small>

		</h3>

		<ul class="breadcrumb">

			<li><i class="icon-home"></i> <a href="">主页</a> <span
				class="icon-angle-right"></span></li>

			<li><a href="#">资产使用情况</a> <span class="icon-angle-right"></span>

			</li>

			<li><a href="asform_layin.html" id="useview"></a></li>

		</ul>

	</div>

</div>
<div class="row-fluid">
	<div class="span12">

		<!-- BEGIN SAMPLE TABLE PORTLET-->

		<div class="portlet box red">
			<div class="portlet-title">
				<div class="caption">
					<i class="icon-cogs"></i>查询
				</div>
				<div class="actions">
					<!--<a href="#" class="btn yellow "><i class="icon-pencil"></i> Edit</a>-->
					<button onclick="findAssetInfoBytiaojian(1)" data-toggle="modal"
						class="btn green ">
						<i class="icon-search"></i> 查询
					</button>
				</div>
			</div>

			<div class="portlet-body">
				<!-- BEGIN FORM-->

				<form action="#" class="form-horizontal">
					<div class="row-fluid">
						<div class="control-group">
							<label class="control-label span2">资产名称</label>
							<div class="controls span2">
								<input id="assetInfoName" type="text" placeholder="设备名称"
									class="m-wrap medium" />
							</div>
							<label class="control-label span3">类型名称</label>

							<div class="controls span2">

								<select class="medium m-wrap" tabindex="1" id="assetType">
									<option value="">请选择</option>
								</select>

							</div>

						</div>
						<div class="row-fluid">
							<div class="control-group">
								<label class="control-label span2">仓库名称</label>
								<div class="controls span2">
									<select class="medium m-wrap" tabindex="1" id="selectwareHouse">
										<option value="">请选择</option>
									</select>
								</div>
								<!-- 
								<label class="control-label span3">进库时间</label>

								<div class="controls span2">
									<div class="input-append date date-picker m-wrap medium"
										data-date="2016/12/02" data-date-format="yyyy/mm/dd"
										data-date-viewmode="years">

										<input class="m-wrap m-ctrl-medium date-picker" readonly
											size="16" type="text" value="" /> <span class="add-on"><i
											class="icon-calendar"></i></span>
									</div>
								</div>
								 -->
							</div>
						</div>
					</div>
				</form>
				<!-- END FORM-->
			</div>

		</div>
		<!-- END SAMPLE TABLE PORTLET-->
	</div>


</div>

<!-- END PAGE HEADER-->

<!-- BEGIN PAGE CONTENT-->

<div class="row-fluid">

	<div class="span12">

		<!-- BEGIN SAMPLE FORM PORTLET-->

		<div class="portlet box red tabbable">



			<div class="portlet-body form" style="padding-left:10px;">

				<div class="tabbable portlet-tabs">



					<div class="row-fluid"
						style="margin-left:-10px;padding-right:10px;">
						<div class="span12">
							<div class="portlet box red">

								<div class="portlet-title">

									<div class="caption">
										<i class="icon-globe"></i>查询详情列表
									</div>

									<div class="tools">

										<a href="javascript:;" class="reload"></a> <a
											href="javascript:;" class="remove"></a>

									</div>

								</div>

								<div class="portlet-body">

									<table class="table ">

										<thead>

											<tr>
												<th>设备名称</th>

												<th>设备型号</th>

												<th>类型名称</th>

												<th>仓库名称</th>

												<th>生产日期</th>

												<th>生产单位</th>

												<th>保质期</th>

												<th>设备备注</th>

												<th>设备状态</th>

											</tr>

										</thead>

										<tbody id="accept-tbody">

										</tbody>

									</table>



									<!-- END EXAMPLE TABLE PORTLET-->

									<!-- END SAMPLE FORM PORTLET-->

								</div>

							</div>
							<center>
								<a href="javascript:findAssetByasname('使用中',1);"
									data-toggle="modal" class="btn red ">首页</a> | <a id="perPage"
									href="" data-toggle="modal" class="btn red ">上一页</a> | <a
									id="nextPage" href="" data-toggle="modal" class="btn red ">下一页</a>
								| <a id="lastPage" href="" data-toggle="modal" class="btn red ">尾页</a>
								| 第<span id="currentPage"></span>页 | 共<span id="totalRecord"></span>条

							</center>

						</div>

					</div>

				</div>

			</div>

			<!-- END SAMPLE FORM PORTLET-->

		</div>

	</div>

	<!-- END PAGE CONTENT-->

</div>

<script>
	var usestatus = "使用中";

	jQuery(document).ready(function() {
		findAssetByasname(usestatus, 1);
		selectWareHouse1();
		selectAllSecondAssetType();
	});

	//根据资产使用情况查询资产
	function findAssetByasname(usestatus, page) {
		$.ajax({
			type : "POST",
			url : "/sam/infoController/findInfoByAsname",
			data : "asname=" + usestatus + "&page=" + page,
			dataType : "JSON",
			success : function(data) {
				//总页数
				var totalPage = data.totalPage;

				//当前页码
				var currentPage = data.currentPage;
				$("#currentPage").html(currentPage);
				var perPagenum;
				perPagenum = page - 1;
				if (perPagenum < 1) {
					perPagenum = 1;
				}
				$("#perPage").attr(
						"href",
						"javascript:findAssetByasname('" + usestatus + "','"
								+ perPagenum + "');");

				var lastpagenum;
				nextPage = page + 1;
				if (nextPage > totalPage) {
					nextPage = totalPage;
				}
				$("#nextPage").attr(
						"href",
						"javascript:findAssetByasname('" + usestatus + "','"
								+ nextPage + "');");
				$("#lastPage").attr(
						"href",
						"javascript:findAssetByasname('" + usestatus + "','"
								+ totalPage + "');");

				//总条目数
				var totalRecord = data.totalRecord;
				$("#totalRecord").html(totalRecord);

				var assetInfoList = data.dataList;

				if (assetInfoList.length == 0) {
					alert("没有该状态下的资产");
					$("#accept-tbody").append(
							"<center>" + "<h2>没有该状态下的资产</h2>" + "</center>");

				}
				$("#accept-tbody").html("");
				for (var i = 0; i < assetInfoList.length; i++) {

					$("#accept-tbody").append(
							"<tr>" + "<td>" + assetInfoList[i].ainame + "</td>"
									+ "<td>" + assetInfoList[i].aimodel
									+ "</td>" + "<td>"
									+ assetInfoList[i].atname + "</td>"
									+ "<td>" + assetInfoList[i].ahname
									+ "</td>" + "<td>"
									+ assetInfoList[i].aimeasuer + "</td>"
									+ "<td>" + assetInfoList[i].aisupply
									+ "</td>" + "<td>"
									+ assetInfoList[i].ailife + "</td>"
									+ "<td>" + assetInfoList[i].airemark
									+ "</td>" + "<td>"
									+ assetInfoList[i].asname + "</td>"
									+ "</tr>");
				}
			},
			error : function() {
				alert("出错了");
			}
		});
	}
	//在使用状态中条件查询
	function findAssetInfoBytiaojian(page) {
		var assetInfoName = $("#assetInfoName").val();
		var assetType = $("#assetType").val();
		var selectwareHouse = $("#selectwareHouse").val();
		var asname = "使用中";

		var tiaojian = {
			"ainame" : assetInfoName,
			"atname" : assetType,
			"ahname" : selectwareHouse,
			"pageNum" : page,
			"asname" : asname

		};
		$.ajax({
			type : "post",
			url : "/sam/infoController/findAssetByCondition",
			data : tiaojian,
			dataType : "JSON",
			success : function(data) {
				//总页数
				var totalPage = data.totalPage;

				//当前页码
				var currentPage = data.currentPage;
				$("#currentPage").html("");
				$("#currentPage").html(currentPage);

				var perPagenum;
				perPagenum = page - 1;
				if (perPagenum < 1) {
					perPagenum = 1;
				}
				$("#perPage").attr(
						"href",
						"javascript:findAssetInfoBytiaojian(" + perPagenum
								+ ");");
				var lastpagenum;
				nextPage = page + 1;
				if (nextPage > totalPage) {
					nextPage = totalPage;
				}
				$("#nextPage")
						.attr(
								"href",
								"javascript:findAssetInfoBytiaojian("
										+ nextPage + ");");
				$("#lastPage").attr(
						"href",
						"javascript:findAssetInfoBytiaojian(" + totalPage
								+ ");");

				//总条目数
				var totalRecord = data.totalRecord;
				$("#totalRecord").html("");
				$("#totalRecord").html(totalRecord);

				var assetInfoList = data.dataList;
				$("#accept-tbody").html("");
				for (var i = 0; i < assetInfoList.length; i++) {
					$("#accept-tbody").append(
							"<tr>" + "<td>" + assetInfoList[i].ainame + "</td>"
									+ "<td>" + assetInfoList[i].aimodel
									+ "</td>" + "<td>"
									+ assetInfoList[i].atname + "</td>"
									+ "<td>" + assetInfoList[i].ahname
									+ "</td>" + "<td>"
									+ assetInfoList[i].aimeasuer + "</td>"
									+ "<td>" + assetInfoList[i].aisupply
									+ "</td>" + "<td>"
									+ assetInfoList[i].ailife + "</td>"
									+ "<td>" + assetInfoList[i].airemark
									+ "</td>" + "<td>"
									+ assetInfoList[i].asname + "</td>"
									+ "</tr>");
				}
			},
			error : function(data) {
				alert("出错了" + data.status);
			}
		});
	}
	//遍历全部仓库
	function selectWareHouse1() {
		$.ajax({
			type : "get",
			url : "/sam/wareHouse/findAllSecondAssetHouse",
			dataType : "JSON",
			success : function(data) {
				$("#selectwareHouse").html("");
				$("#selectwareHouse").append('<option value="">请选择</option>');
				$(data).each(
						function(index, value) {
							$("#selectwareHouse").append(
									"<option value='"+value.ahname+"'>"
											+ value.ahname + "</option>");
						});

			},
			error : function(data) {
				alert(data.status);
			}
		});

	}

	//遍历全部二级类型
	function selectAllSecondAssetType() {
		$.ajax({
			type : "get",
			url : "/sam/assetType/findAllSecondAssetType",
			dataType : "JSON",
			success : function(data) {
				$("#assetType").html("");
				$("#assetType").append('<option value="">请选择</option>');
				$(data).each(
						function(index, value) {
							$("#assetType").append(
									"<option value='"+value.atname+"'>"
											+ value.atname + "</option>");
						});

			},
			error : function(data) {
				alert(data.status);
			}
		});

	}
</script>

